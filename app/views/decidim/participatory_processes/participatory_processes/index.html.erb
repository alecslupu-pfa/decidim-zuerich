<%# Overridden view from decidim, for displaying process groups specially, issue #246 %>
<% add_decidim_meta_tags(title: t("participatory_processes.index.title", scope: "decidim")) %>

<%
edit_link(
  decidim_admin_participatory_processes.participatory_processes_path,
  :read,
  :process_list
)
%>

<%= participatory_space_wrapper do %>
  <% if promoted_collection.any? %>
    <section id="highlighted-processes" class="row section">
      <h1 class="section-heading"><%= t("participatory_processes.index.promoted_processes", scope: "layouts.decidim") %></h1>
      <% promoted_collection.each do |promoted_item| %>
        <%= render_highlighted_partial_for promoted_item %>
      <% end %>
    </section>
  <% end %>

  <section id="process-groups" class="row section">
    <% participatory_process_groups.each do |process_group| %>
      <h1 class="section-heading">
        <% if has_landing_page(process_group) %>
          <%= link_to translated_attribute(process_group.title), participatory_process_group_path(process_group) %>
        <% else %>
          <%= translated_attribute(process_group.title) %>
        <% end %>
      </h1>
      <div class="row small-up-1 medium-up-2 large-up-3 card-grid">
        <%= render(process_group.participatory_processes.where(id: filtered_processes)) %>
      </div>
      <% if has_landing_page(process_group) %>
        <div class="column">
          <%= link_to t("decidim.participatory_processes.index.participatory_process_group.more_info"), participatory_process_group_path(process_group), class: 'button button--sc pull-right' %>
        </div>
      <% end %>
    <% end %>
  </section>

  <section id="processes-grid" class="section row collapse">
    <div class="processes-grid-order-by">
      <%= render partial: "order_by_processes" %>
    </div>
    <%= render partial: "decidim/shared/participatory_space_filters/show" %>
    <p class="loading"><%= t(".loading") %></p>
    <div class="row small-up-1 medium-up-2 large-up-3 card-grid">
      <%= render(collection) %>
    </div>
  </section>
<% end %>

<%= javascript_pack_tag "decidim_participatory_processes" %>
